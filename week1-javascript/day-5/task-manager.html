<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap");
      * {
        box-sizing: border-box;
      }
      body {
        font-family: "Roboto", sans-serif;
        padding: 20px;
        line-height: 1.3;
      }

      ul {
        max-width: 400px;
        padding-left: 0;
      }
      input[type="text"] {
        height: 40px;
        padding-left: 10px;
        width: 400px;
        display: block;
        margin-bottom: 10px;
        border-radius: 4px;
        outline: none;
        border: 1px solid #ccc;
        font-family: "Roboto", sans-serif;
        font-size: 16px;
      }
      #task {
        height: 40px;
        width: 100px;
        font-size: 14px;
        font-family: "Roboto", sans-serif;
        border: none;
        background-color: brown;
        color: white;
        border-radius: 4px;
        cursor: pointer;
      }
      ul li {
        display: flex;
        justify-content: space-between;
        gap: 10px;
        align-items: center;
        border: 1px solid #ccc;
        padding: 10px;
        border-radius: 4px;
        margin-bottom: 10px;
      }
      .text-right {
        max-width: 400px;
        text-align: right;
      }
      .delete {
        width: 40px;
        border: none;
        background-color: red;
        color: white;
        border-radius: 4px;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      label {
        display: flex;
        align-items: center;
        gap: 5px;
      }
      .complete {
        text-decoration: line-through;
      }
    </style>
  </head>
  <body>
    <h1>Task Manager</h1>

    <input type="text" id="input" placeholder="Write down..." />
    <div class="text-right">
      <button id="addtask">Add Task</button>
    </div>
    <ul id="tasks">
      <li>
        <label class="complete"
          ><input type="checkbox" /> <span>sdfsd</span></label
        ><button class="delete">X</button>
      </li>
    </ul>
    <script>
      const input = document.querySelector("#input");
      const addBtn = document.querySelector("#addtask");
      const tasks = document.querySelector("#tasks");
      let lists = [];

      addBtn.addEventListener("click", function () {
        const taskValue = input.value;
        if (taskValue.length < 6) {
          alert("Please enter task");
          return;
        }

        addTask(taskValue);
        input.value = ''
      });

      const addTask = (item) => {
        lists.push({ name: item, isCompleted: false });
        const list_String = JSON.stringify(lists);
        localStorage.setItem("tasks", list_String);
        putList();
      };

      const putList = () => {
        tasks.innerHTML = "";
        const list = localStorage.getItem("tasks");
        if (list) {
          lists = JSON.parse(list);
          lists.forEach(function (item, index) {
            tasks.innerHTML += `
                    <li><label class="${
                      item.isCompleted ? "complete" : ""
                    }"><input type="checkbox"  ${
              item.isCompleted ? "checked" : ""
            } data-id="${index}" class="toggleComplete "> <span>${
              item.name
            }</span></label><button class="delete" data-id="${index}">X</button></li>
                    `;
          });
        }
      };
      putList();

      tasks.addEventListener("click", (e) => {
        //event catptured
        if (e.target.classList.contains("toggleComplete")) {
          const index = event.target.getAttribute("data-id");
          if (e.target.checked) {
            lists.map((item, i) => {
              if (i == index) item.isCompleted = true;
              return item;
            });
            e.target.closest("label").classList.add("complete");
          } else {
            lists.map((item, i) => {
              if (i == index) item.isCompleted = false;
              return item;
            });
            e.target.closest("label").classList.remove("complete");
          }

          const list_String = JSON.stringify(lists);
          localStorage.setItem("tasks", list_String);
        }

        if (e.target.classList.contains("delete")) {
            const Myindex = event.target.getAttribute("data-id");
            const updatedList = lists.filter((item,index) =>  index!==Number(Myindex));
            lists = updatedList
            console.log(lists)
            e.target.closest("li").remove()
            const list_String = JSON.stringify(lists);
            localStorage.setItem("tasks", list_String);
        }
      });
    </script>
  </body>
</html>
